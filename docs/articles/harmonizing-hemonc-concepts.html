<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Harmonizing HemOnc Concepts • chariot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Harmonizing HemOnc Concepts">
<meta property="og:description" content="chariot">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">chariot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/harmonizing-hemonc-concepts.html">Harmonizing HemOnc Concepts</a>
    </li>
    <li>
      <a href="../articles/mapping-to-hemonc.html">Mapping to HemOnc</a>
    </li>
    <li>
      <a href="../articles/pivot-concept-ancestor.html">Pivot Concept Ancestors and Descendants</a>
    </li>
    <li>
      <a href="../articles/pivot-concept-relationships.html">Pivot Concept Relationships</a>
    </li>
    <li>
      <a href="../articles/setup-drug-strength.html">Setup Drug Strength</a>
    </li>
    <li>
      <a href="../articles/string-manipulation.html">String Manipulation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/meerapatelmd/chariot/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Harmonizing HemOnc Concepts</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/meerapatelmd/chariot/blob/master/vignettes/harmonizing-hemonc-concepts.Rmd"><code>vignettes/harmonizing-hemonc-concepts.Rmd</code></a></small>
      <div class="hidden name"><code>harmonizing-hemonc-concepts.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://meerapatelmd.github.io/chariot/">chariot</a></span><span class="op">)</span>
<span class="co">#&gt; Read GitHub Wiki &lt;https://ohdsi.github.io/CommonDataModel/cdm60.html&gt;</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span>
<span class="co">#&gt; ✓ ggplot2 3.3.3     ✓ purrr   0.3.4</span>
<span class="co">#&gt; ✓ tibble  3.0.4     ✓ dplyr   1.0.2</span>
<span class="co">#&gt; ✓ tidyr   1.1.2     ✓ stringr 1.4.0</span>
<span class="co">#&gt; ✓ readr   1.4.0     ✓ forcats 0.5.0</span>
<span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span></code></pre></div>
<p>Harmonizing HemOnc concepts entails getting a combination of Regimens and Components, reducing the combination down to the Component level, and finding Regimens and/or Regimen and Component combinations that map to the reduced list.</p>
<p>For example, the Regimen FOLFOX along with Irinotecan would harmonize to FOLFIRINOX.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">FOLFOX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_concept.html">get_concept</a></span><span class="op">(</span>concept_id <span class="op">=</span> <span class="fl">35806596</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35806596` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span>
<span class="va">Irinotecan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_concept.html">get_concept</a></span><span class="op">(</span>concept_id <span class="op">=</span> <span class="fl">35803130</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803130` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Postgres connection to 'athena' closed</span></code></pre></div>
<p>To check for this, the FOLFOX plus Irinotecan combination are reduced to Components.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_components</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/ho_reduce_to_components.html">ho_reduce_to_components</a></span><span class="op">(</span><span class="va">FOLFOX</span>,
                        <span class="va">Irinotecan</span><span class="op">)</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; ── Checking Validity ───────────────────────────────────────────────────────────</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Cached SQL: </span>
<span class="co">#&gt;                             SELECT *</span>
<span class="co">#&gt;                             FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                             WHERE c.concept_id IN (35806596,35803130)</span>
<span class="co">#&gt;                                     AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                     AND c.concept_class_id IN ('Regimen', 'Component')</span>
<span class="co">#&gt;                                     AND c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                             </span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Target column: hemonc_concept_ids</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Dropping patelm9.V20210110190821...</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190821;</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Dropping patelm9.V20210110190821...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ Data 'data' has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ Table name 'V20210110190821' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ Field name 'hemonc_concept_ids' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Writing patelm9.V20210110190821...</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Writing patelm9.V20210110190821...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    SQL: SELECT a.*, b.* FROM patelm9.V20210110190821 a LEFT JOIN omop_vocabulary.concept b ON a.hemonc_concept_ids = b.concept_id WHERE b.invalid_reason IS NULL</span>
<span class="co">#&gt; [2021-01-10 19:08:21]    Querying...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Querying...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Returned data has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190821...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190821;</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190821...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Target column: component_id</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190822;</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Data 'data' has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Table name 'V20210110190822' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Field name 'component_id' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Writing patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Writing patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: SELECT a.*, b.* FROM patelm9.V20210110190822 a LEFT JOIN omop_vocabulary.concept b ON a.component_id = b.concept_id WHERE b.invalid_reason IS NULL</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Querying...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Querying...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Returned data has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190822;</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_components</span>
<span class="co">#&gt;   concept_id concept_name domain_id vocabulary_id concept_class_id</span>
<span class="co">#&gt; 1   35803077 Fluorouracil      Drug        HemOnc        Component</span>
<span class="co">#&gt; 2   35803081 Folinic acid      Drug        HemOnc        Component</span>
<span class="co">#&gt; 3   35803227  Oxaliplatin      Drug        HemOnc        Component</span>
<span class="co">#&gt; 4   35803130   Irinotecan      Drug        HemOnc        Component</span>
<span class="co">#&gt;   standard_concept concept_code valid_start_date valid_end_date invalid_reason</span>
<span class="co">#&gt; 1             &lt;NA&gt;          225       2019-05-27     2099-12-31           &lt;NA&gt;</span>
<span class="co">#&gt; 2             &lt;NA&gt;          229       2019-05-27     2099-12-31           &lt;NA&gt;</span>
<span class="co">#&gt; 3             &lt;NA&gt;          377       2019-05-27     2099-12-31           &lt;NA&gt;</span>
<span class="co">#&gt; 4             &lt;NA&gt;          280       2019-05-27     2099-12-31           &lt;NA&gt;</span></code></pre></div>
<p>The components can then be submitted to generate a potential regimen match.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimen</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="../reference/ho_lookup_regimen.html">ho_lookup_regimen</a></span><span class="op">(</span><span class="va">new_components</span><span class="op">$</span><span class="va">concept_id</span><span class="op">)</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803081,35803227,35803130)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Target column: regimen_concept_id</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190822;</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Data 'data' has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Table name 'V20210110190822' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Field name 'regimen_concept_id' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Field name 'has_antineoplastic_concept_id' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Field name 'has_antineoplastic_concept_name' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Writing patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Writing patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: SELECT a.*, b.* FROM patelm9.V20210110190822 a LEFT JOIN omop_vocabulary.concept b ON a.regimen_concept_id = b.concept_id WHERE b.invalid_reason IS NULL</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Querying...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Querying...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Returned data has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190822;</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Dropping patelm9.V20210110190822...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimen</span>
<span class="co">#&gt;    regimen_concept_id                                  regimen_concept_name</span>
<span class="co">#&gt; 1            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 2            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 3            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 4            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 5            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 6            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 7            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 8            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 9            35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 10           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 11           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 12           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt;    has_antineoplastic_concept_id has_antineoplastic_concept_name</span>
<span class="co">#&gt; 1                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 2                       35803081                    Folinic acid</span>
<span class="co">#&gt; 3                       35803130                      Irinotecan</span>
<span class="co">#&gt; 4                       35803227                     Oxaliplatin</span>
<span class="co">#&gt; 5                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 6                       35803081                    Folinic acid</span>
<span class="co">#&gt; 7                       35803130                      Irinotecan</span>
<span class="co">#&gt; 8                       35803227                     Oxaliplatin</span>
<span class="co">#&gt; 9                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 10                      35803081                    Folinic acid</span>
<span class="co">#&gt; 11                      35803130                      Irinotecan</span>
<span class="co">#&gt; 12                      35803227                     Oxaliplatin</span></code></pre></div>
<p>In this case, various combinations existed. However, what if a combination does not cleanly map to a HemOnc Regimen? For example, sometimes there is an add-on drug to an established Regimen for experimental reasons.</p>
<p>For demonstration purposes, suppose the new Components reduced down to Fluorouracil, Folinic acid, Oxaliplatin, and Irinotecan as well as Trastuzumab.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Trastuzumab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_concept.html">get_concept</a></span><span class="op">(</span>concept_id <span class="op">=</span> <span class="fl">35803361</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803361` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:22]    Postgres connection to 'athena' closed</span>
<span class="va">Trastuzumab</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803361</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Trastuzumab"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "trastuzumab"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "512"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_component_ids2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">new_components</span><span class="op">$</span><span class="va">concept_id</span>, <span class="va">Trastuzumab</span><span class="op">@</span><span class="va">concept_id</span><span class="op">)</span>
<span class="va">new_component_ids2</span>
<span class="co">#&gt; [1] 35803077 35803081 35803227 35803130 35803361</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimen2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ho_lookup_regimen.html">ho_lookup_regimen</a></span><span class="op">(</span><span class="va">new_component_ids2</span><span class="op">)</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803081,35803227,35803130,35803361)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 5</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 5</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 5</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 5</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803361)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 5</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span></code></pre></div>
<p>In this case, a regimen was not found as indicated by a zero row result.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimen2</span>
<span class="co">#&gt; # A tibble: 0 x 4</span>
<span class="co">#&gt; # … with 4 variables: regimen_concept_id &lt;???&gt;, regimen_concept_name &lt;???&gt;,</span>
<span class="co">#&gt; #   has_antineoplastic_concept_id &lt;???&gt;, has_antineoplastic_concept_name &lt;???&gt;</span></code></pre></div>
<p>To find possible Regimen and Component combinations instead, subsets of the Components can be submitted to find matches using <code><a href="../reference/ho_grep_regimens.html">ho_grep_regimens()</a></code> with starting <code>component_count</code> 1 value less than the total Component count. In this case, it is 4.</p>
<p>The Concept classes are retrieved for each of the Components.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_component_objs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">new_component_ids2</span>,
                              <span class="va">get_concept</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803077` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803081` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803227` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803130` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Is Concept Id Valid Integer? ────────────────────────────────────────────────</span>
<span class="co">#&gt; ✓ Concept Id is a valid integer</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Concept Id in Concept Table ──────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; ✓ Concept Id `35803361` found in Concept Table</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup Synonyms ─────────────────────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Lookup 'Maps to' Concept Names ──────────────────────────────────────────────</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new_component_objs2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">new_component_objs2</span>,
                                     <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">slot</span><span class="op">(</span><span class="va">x</span>, <span class="st">"concept_name"</span><span class="op">)</span><span class="op">)</span>
<span class="va">new_component_objs2</span>
<span class="co">#&gt; $Fluorouracil</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803077</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Fluorouracil"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] "5 FU|5 Fluorouracil|5-fluoracilo|5-fluorouracilo|5-fluorouracyl|FU|Ro-2-9757"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "fluorouracil"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "225"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Folinic acid`</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803081</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Folinic acid"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] "LV|citrovorum factor|folinate calcium|folinato de calcio|sodium folinate"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "leucovorin"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "229"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Oxaliplatin</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803227</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Oxaliplatin"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] "JM-83|RP-54780|SR-96669"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "oxaliplatin"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "377"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Irinotecan</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803130</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Irinotecan"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] "CPT-11|Camptothecin-11|U-101440E"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "irinotecan"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "280"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Trastuzumab</span>
<span class="co">#&gt; An object of class "concept"</span>
<span class="co">#&gt; Slot "concept_id":</span>
<span class="co">#&gt; [1] 35803361</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_name":</span>
<span class="co">#&gt; [1] "Trastuzumab"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_synonym_names":</span>
<span class="co">#&gt; [1] ""</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "maps_to_concept_names":</span>
<span class="co">#&gt; [1] "trastuzumab"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "domain_id":</span>
<span class="co">#&gt; [1] "Drug"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "vocabulary_id":</span>
<span class="co">#&gt; [1] "HemOnc"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_class_id":</span>
<span class="co">#&gt; [1] "Component"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "standard_concept":</span>
<span class="co">#&gt; [1] NA</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "concept_code":</span>
<span class="co">#&gt; [1] "512"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_start_date":</span>
<span class="co">#&gt; [1] "2019-05-27"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "valid_end_date":</span>
<span class="co">#&gt; [1] "2099-12-31"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Slot "invalid_reason":</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>All the possible Component permutations are made by removing one of the Components.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_component_permutations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">new_component_objs2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">new_component_permutations</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span>
  <span class="va">new_component_objs2</span><span class="op">[</span><span class="op">-</span><span class="va">i</span><span class="op">]</span>
  <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new_component_permutations</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">new_component_objs2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">concept_name</span>
<span class="op">}</span></code></pre></div>
<p>The resulting input is of the same length as the source Components (5) and each value in the list is composed of 4 (5 minus 1) Components. The names of the removed Component in a particular permutation is also saved as the name.</p>
<p>The permutations are mapped to Regimens.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimens2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">new_component_permutations</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">new_regimens2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/ho_lookup_regimen.html">ho_lookup_regimen</a></span><span class="op">(</span><span class="va">new_component_permutations</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803081,35803227,35803130,35803361)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803361)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803227,35803130,35803361)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803361)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803081,35803130,35803361)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803361)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803081,35803227,35803361)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803361)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: SELECT *</span>
<span class="co">#&gt;                              FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                              WHERE c.concept_id IN (35803077,35803081,35803227,35803130)</span>
<span class="co">#&gt;                                 AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 AND c.concept_class_id &lt;&gt; 'Component';</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803077)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803081)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803227)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Loading Cache...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached SQL: WITH component_regimens AS (</span>
<span class="co">#&gt;                                         SELECT cr.concept_id_2 AS regimen_i_concept_id</span>
<span class="co">#&gt;                                         FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                         LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                         ON cr.concept_id_1 = c.concept_id</span>
<span class="co">#&gt;                                         WHERE c.concept_id IN (35803130)</span>
<span class="co">#&gt;                                             AND cr.relationship_id = 'Antineoplastic of'</span>
<span class="co">#&gt;                                             AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                 ),</span>
<span class="co">#&gt;                                 regimens AS (</span>
<span class="co">#&gt;                                        SELECT DISTINCT cr.concept_id_1 AS regimen_concept_id</span>
<span class="co">#&gt;                                        FROM omop_vocabulary.concept c</span>
<span class="co">#&gt;                                        LEFT JOIN omop_vocabulary.concept_relationship cr</span>
<span class="co">#&gt;                                        ON c.concept_id = cr.concept_id_1</span>
<span class="co">#&gt;                                        WHERE c.vocabulary_id = 'HemOnc'</span>
<span class="co">#&gt;                                        AND c.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND c.concept_class_id = 'Regimen'</span>
<span class="co">#&gt;                                        AND cr.invalid_reason IS NULL</span>
<span class="co">#&gt;                                        AND cr.relationship_id = 'Has antineoplastic'</span>
<span class="co">#&gt;                                        GROUP BY cr.concept_id_1</span>
<span class="co">#&gt;                                        HAVING COUNT(cr.concept_id_2) = 4</span>
<span class="co">#&gt;                                 )</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 SELECT t.*</span>
<span class="co">#&gt;                                 FROM component_regimens cr</span>
<span class="co">#&gt;                                 INNER JOIN regimens t</span>
<span class="co">#&gt;                                 ON t.regimen_concept_id = cr.regimen_i_concept_id</span>
<span class="co">#&gt;                                 ;</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Cached resultset found...</span>
<span class="co">#&gt; [2021-01-10 19:08:23]    Target column: regimen_concept_id</span>
<span class="co">#&gt; Connecting using PostgreSQL driver</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Dropping patelm9.V20210110190824...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190824;</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Dropping patelm9.V20210110190824...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Data 'data' has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Table name 'V20210110190824' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Field name 'regimen_concept_id' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Field name 'has_antineoplastic_concept_id' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Field name 'has_antineoplastic_concept_name' is not a reserved word</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Writing patelm9.V20210110190824...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Writing patelm9.V20210110190824...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    SQL: SELECT a.*, b.* FROM patelm9.V20210110190824 a LEFT JOIN omop_vocabulary.concept b ON a.regimen_concept_id = b.concept_id WHERE b.invalid_reason IS NULL</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Querying...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Querying...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Returned data has more than 0 rows</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Dropping patelm9.V20210110190824...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ Open connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    </span>
<span class="co">#&gt; ✓ JDBC connection</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    SQL: DROP TABLE IF EXISTS patelm9.V20210110190824;</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Sending...</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Sending...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Dropping patelm9.V20210110190824...complete</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Postgres connection to 'athena' closed</span>
<span class="co">#&gt; [2021-01-10 19:08:24]    Postgres connection to 'athena' closed</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new_regimens2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">new_component_permutations</span><span class="op">)</span>
<span class="va">new_regimens2</span> <span class="op">&lt;-</span>
  <span class="va">new_regimens2</span> <span class="op">%&gt;%</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/keep.html">keep</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">new_regimens2</span>
<span class="co">#&gt; $Trastuzumab</span>
<span class="co">#&gt;    regimen_concept_id                                  regimen_concept_name</span>
<span class="co">#&gt; 1            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 2            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 3            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 4            35804771                                            FOLFIRINOX</span>
<span class="co">#&gt; 5            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 6            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 7            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 8            35806584                                           mFOLFIRINOX</span>
<span class="co">#&gt; 9            35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 10           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 11           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt; 12           35807526 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span>
<span class="co">#&gt;    has_antineoplastic_concept_id has_antineoplastic_concept_name</span>
<span class="co">#&gt; 1                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 2                       35803081                    Folinic acid</span>
<span class="co">#&gt; 3                       35803130                      Irinotecan</span>
<span class="co">#&gt; 4                       35803227                     Oxaliplatin</span>
<span class="co">#&gt; 5                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 6                       35803081                    Folinic acid</span>
<span class="co">#&gt; 7                       35803130                      Irinotecan</span>
<span class="co">#&gt; 8                       35803227                     Oxaliplatin</span>
<span class="co">#&gt; 9                       35803077                    Fluorouracil</span>
<span class="co">#&gt; 10                      35803081                    Folinic acid</span>
<span class="co">#&gt; 11                      35803130                      Irinotecan</span>
<span class="co">#&gt; 12                      35803227                     Oxaliplatin</span></code></pre></div>
<p>Filtering for only the permutations that returned greater than zero rows, there are 3 potential regimens that a subset of 4 Components map to:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">new_regimens2</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span>.id <span class="op">=</span> <span class="st">"add_on_component_name"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">add_on_component_name</span>, <span class="va">regimen_concept_id</span>, <span class="va">regimen_concept_name</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">distinct</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;   add_on_component_name regimen_concept_id</span>
<span class="co">#&gt; 1           Trastuzumab           35804771</span>
<span class="co">#&gt; 2           Trastuzumab           35806584</span>
<span class="co">#&gt; 3           Trastuzumab           35807526</span>
<span class="co">#&gt;                                    regimen_concept_name</span>
<span class="co">#&gt; 1                                            FOLFIRINOX</span>
<span class="co">#&gt; 2                                           mFOLFIRINOX</span>
<span class="co">#&gt; 3 FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation</span></code></pre></div>
<p>Therefore, the possible combinations are either FOLFIRINOX plus Trastuzumab, mFOLFIRINOX plus Trastuzumab, or FOLFIRINOX/modified FOLFIRINOX plus /- Chemoradiation plus Trastuzumab.</p>
<p>It is possible that the permutations do not return any rows in this scenario. If this is the case, it is likely more feasible to manually look up the mapping at  than to programmatically find matches.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Meera Patel, MD.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
